---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "ciphertrust_scheduler Resource - terraform-provider-ciphertrust"
subcategory: ""
description: |-
  
---

# ciphertrust_scheduler (Resource)

The ciphertrust_scheduler resource allows you to define and manage scheduled jobs within the CipherTrust Manager. This resource enables setting up automated tasks such as database backups with customizable parameters, including backup keys, connections, retention policies, and more. You can configure the scheduling using cron-style expressions to specify when the jobs should run.



<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) The name of the job configuration
- `operation` (String) The database_backup_params param must be specified for the database_backup operation
- `run_at` (String) Described using the cron expression format : "* * * * *" These five values indicate when the job should be executed. They are in order of minute, hour, day of month, month, and day of week. Valid values are 0-59 (minutes), 0-23 (hours), 1-31 (day of month), 1-12 or jan-dec (month), and 0-6 or sun-sat (day of week). Names are case insensitive. For use of special characters, consult the Time Specification description at the top of this page.

For example:

    To run every min: "* * * * *"
    To run on Saturday at 23:45(11:45 PM): "45 23 * * 6"
    To run on Monday at 09:00: "0 9 * * 1"

### Optional

- `database_backup_params` (Attributes) Database backup operation specific arguments. Should be JSON-serializable. Required only for "database_backup" operations. Not allowed for other operations. (see [below for nested schema](#nestedatt--database_backup_params))
- `description` (String) Description for the job configuration.
- `disabled` (Boolean) By default, the job configuration starts in an active state. True disables the job configuration.
- `end_date` (String) Date the job configuration becomes inactive. RFC3339 format. For example, 2018-10-02T14:24:37.436073Z
- `run_on` (String) Default is 'any'. For database_backup, the default will be the current node if in a cluster.
- `start_date` (String) Date the job configuration becomes active. RFC3339 format. For example, 2018-10-02T14:24:37.436073Z

### Read-Only

- `account` (String)
- `application` (String)
- `created_at` (String)
- `dev_account` (String)
- `id` (String) The ID of this resource.
- `updated_at` (String)
- `uri` (String)

<a id="nestedatt--database_backup_params"></a>
### Nested Schema for `database_backup_params`

Optional:

- `backup_key` (String) ID of backup key used for encrypting the backup. The default backup key is used if this is not specified.
- `connection` (String) Name or ID of the SCP connection which stores the details for SCP server.
- `description` (String) User defined description associated with the backup. This is stored along with the backup, and is returned while retrieving the backup information, or while listing backups. Users may find it useful to store various types of information here: a backup name or description, ID of the HSM the backup is tied to, etc.
- `do_scp` (Boolean) If true, the system backup will also be transferred to the external server via SCP.
- `filters` (Attributes List) A set of selection criteria to specify what resources to include in the backup. Only applicable to domain-scoped backups. By default, no filters are applied and the backup includes all keys. For example, to back up all keys with a name containing 'enc-key', set the filters to [{"resourceType": "Keys", "resourceQuery":{"name":"*enc-key*"}}]. (see [below for nested schema](#nestedatt--database_backup_params--filters))
- `retention_count` (Number) Number of backups saved for this job config. Default is an unlimited quantity.
- `scope` (String) Scope of the backup to be taken - system (default) or domain.
- `tied_to_hsm` (Boolean) If true, the system backup can only be restored to instances that use the same HSM partition. Valid only with the system scoped backup.

<a id="nestedatt--database_backup_params--filters"></a>
### Nested Schema for `database_backup_params.filters`

Required:

- `resource_type` (String) Type of resources to be backed up. Valid values are "Keys", "cte_policies", "customer_fragments" and, "users_groups".

Optional:

- `resource_query` (String) A JSON object containing resource attributes and attribute values to be queried. The resources returned in the query are backed up. If empty, all the resources of the specified resourceType will be backed up. For Keys, valid resourceQuery paramater values are the same as the body of the 'vault/query-keys' POST endpoint described on the Keys page. If multiple parameters of 'vault/query-keys' are provided then the result will be AND of all. To back up AES keys with a meta parameter value containing {"info":{"color":"red"}}}, use {"algorithm":"AES", "metaContains": {"info":{"color":"red"}}}. To backup specific keys using names, use {"names":["key1", "key2"]}.

For CTE policies, valid resourceQuery parameter values are the same as query parameters of the list '/v1/transparent-encryption/policies' endpoint described in the CTE > Policies section. For example, to back up LDT policies only, use {"policy_type":"LDT"}. Similarly, to back up policies with learn mode enabled, use {"never_deny": true}. For users, the valid resourceQuery parameter values are the same as query parameters of the list '/v1/usermgmt/users' endpoint as described in the “Users” page. For example, to back up all users with name "frank" and email id "frank@local", use {"name":"frank","email": "frank@local"}.

For Customer fragments, valid resourceQuery parameter values are 'ids' and 'names' of Customer fragments. To backup specific customer fragments using ids, use {"ids":["370c4373-2675-4aa1-8cc7-07a9f95a5861", "4e1b9dec-2e38-40d7-b4d6-244043200546"]}. To backup specific customer fragments using names, use {"names":["customerFragment1", "customerFragment2"]}.

Note: When providing resource_query as a JSON string, ensure proper escaping of special characters like quotes (") and use \n for line breaks if entering the JSON in multiple lines.

For example:

     filters = [
      {
        resource_type = "customer_fragments"
        resource_query = jsonencode({
          ids = ["56fc2127-3a96-428e-b93b-ab169728c23c", "a6c8d8eb-1b69-42f0-97d7-4f0845fbf602"]
        })
      }
    ]
NOTE: resource_query has to be json encoded.

## Run the Example

```bash
terraform init
terraform apply
```

## Destroy Resources

Resources must be destroyed before another sample script using the same cloud is run.

```bash
terraform destroy
```
Run this step even if the apply step fails.
